{"version":3,"sources":["webpack:///src/app/PAGES_BENE/bene-map/bene-map.page.html","webpack:///src/app/PAGES_BENE/bene-map/bene-map-routing.module.ts","webpack:///src/app/PAGES_BENE/bene-map/bene-map.module.ts","webpack:///src/app/PAGES_BENE/bene-map/bene-map.page.scss","webpack:///src/app/PAGES_BENE/bene-map/bene-map.page.ts"],"names":["routes","path","component","BeneMapPageRoutingModule","imports","forChild","exports","BeneMapPageModule","declarations","BeneMapPage","Afs","router","console","log","markerinvasion","createMap","maphome","center","zoom","renderer","homeMarker","lat","lng","bindPopup","closeButton","addTo","pop","id","mark","draggable","on","clickEvent","goTo","attribution","minZoom","maxZoom","setTimeout","invalidateSize","size$","queryObservable","pipe","size","collection","valueChanges","eventObserver","subscribe","queriedItems","obj","length","i","titre","geolat","geolng","addMarker","next","postID","navigate","unsubscribe","selector","template"],"mappings":"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","file":"bene-map-bene-map-module-es5.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>Proche de chez vous</ion-title>\\n    <ion-buttons slot=\\\"end\\\">\\n    </ion-buttons>\\n  </ion-toolbar>\\n\\n</ion-header>\\n\\n<ion-content>\\n\\n    <div id=\\\"maphome\\\" ></div>\\n    <script *ngFor=\\\"let item of items | async\\\">\\n      \\n    </script>\\n    \\n   \\n \\n\\n</ion-content>\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { BeneMapPage } from './bene-map.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: BeneMapPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class BeneMapPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { BeneMapPageRoutingModule } from './bene-map-routing.module';\n\nimport { BeneMapPage } from './bene-map.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    BeneMapPageRoutingModule\n  ],\n  declarations: [BeneMapPage]\n})\nexport class BeneMapPageModule {}\n","export default \"#maphome {\\n  min-height: 100%;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvUEFHRVNfQkVORS9iZW5lLW1hcC9DOlxcVXNlcnNcXFV0aWxpc2F0ZXVyXFx1bmliZWUvc3JjXFxhcHBcXFBBR0VTX0JFTkVcXGJlbmUtbWFwXFxiZW5lLW1hcC5wYWdlLnNjc3MiLCJzcmMvYXBwL1BBR0VTX0JFTkUvYmVuZS1tYXAvYmVuZS1tYXAucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBO0VBQ0ksZ0JBQWdCO0FDQXBCIiwiZmlsZSI6InNyYy9hcHAvUEFHRVNfQkVORS9iZW5lLW1hcC9iZW5lLW1hcC5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuI21hcGhvbWV7XHJcbiAgICBtaW4taGVpZ2h0OiAxMDAlO1xyXG4gIH0iLCIjbWFwaG9tZSB7XG4gIG1pbi1oZWlnaHQ6IDEwMCU7XG59XG4iXX0= */\";","import { Router } from '@angular/router';\nimport { switchMap } from 'rxjs/operators';\nimport { AngularFirestore } from '@angular/fire/firestore';\n\nimport { Component, AfterViewInit, OnDestroy } from '@angular/core';\nimport * as L from 'leaflet'\nimport { Subject } from 'rxjs';\n\nimport \"leaflet/dist/images/marker-shadow.png\";\nimport \"leaflet/dist/images/marker-icon.png\";\nimport \"leaflet/dist/images/marker-icon-2x.png\";\n\n@Component({\n  selector: 'app-bene-map',\n  templateUrl: './bene-map.page.html',\n  styleUrls: ['./bene-map.page.scss'],\n})\nexport class BeneMapPage implements AfterViewInit {\n  maphome: L.Map\n  items\n  obj\n  mark\n  queryObservable\n  eventObserver\n  constructor(private Afs: AngularFirestore, private router: Router) { }\n\n  ionViewWillEnter() {\n    console.log('ionwillenter')\n    console.log('ionwillenter')\n    console.log('ionwillenter')\n    console.log('ionwillenter')\n    console.log('ionwillenter')\n    console.log('ionwillenter')\n     this.markerinvasion(); }\n  ngAfterViewInit() {\n    this.createMap();\n  }\n\n\n  createMap() {\n    \n    this.maphome = L.map('maphome', {\n      center: [48.298246, 4.078672],\n      zoom: 12,\n      renderer: L.canvas()\n    })\n  }\n \n  addHomeMarker() {\n    const homeMarker = L.marker({ lat: 48.4, lng: 4.0833 })\n    homeMarker.bindPopup('This is the voice', {\n      closeButton: true\n    })\n    homeMarker.addTo(this.maphome)\n\n  } \n\n  addMarker(lat, lng, pop, id) {\n    this.mark = L.marker({ lat: lat, lng: lng }, { draggable: false })\n    this.mark.bindPopup(pop, {\n      closeButton: true\n    }).on('click', (clickEvent)=>{this.goTo(id)})\n    this.mark.addTo(this.maphome)\n  }\n \n\n  markerinvasion() {\n    L.tileLayer('//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: 'donn&eacute;es &copy; <a href=\"//osm.org/copyright\">OpenStreetMap</a>/ODbL - rendu <a href=\"//openstreetmap.fr\">OSM France</a>',\n      minZoom: 1,\n      maxZoom: 20\n    }).addTo(this.maphome);\n      // force map to resize on init\n      setTimeout(() => {\n        this.maphome.invalidateSize();\n      }, 0);\n    \n  const size$ = new Subject<string>();\n  this.queryObservable = size$.pipe(\n    switchMap(size => \n      this.Afs.collection('publicevents'/*, ref => ref.where('size', '==', size)*/).valueChanges()\n    )\n  );\n  // is scalar\n  console.log (this.queryObservable)\n  \n  // subscribe to changes\n  this.eventObserver =this.queryObservable.subscribe(queriedItems => {\n    // [{...}, {...}]\n    this.obj= queriedItems;\n    console.log(queriedItems);  \n    console.log(\"gg\"+ queriedItems.length);   \n    for (var i = 0; i < queriedItems.length; i++) {\n      console.log(this.obj[i].titre);\n      console.log(this.obj[i].geolat);\n      console.log(this.obj[i].geolng);\n      this.addMarker(this.obj[i].geolat,this.obj[i].geolng, this.obj[i].titre, this.obj[i].id )\n  }\n  }); \n  // trigger the query\n  size$.next('large'); \n\n}\ngoTo(postID: string){\n  this.router.navigate(['/bene-details/'+ postID])\n} \n\nionViewWillLeave(){\n  console.log('ondestroy')\nthis.eventObserver.unsubscribe();\n}\n\n}\n"]}